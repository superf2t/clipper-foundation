<!doctype html>
<html>
<head>
  <title>{{plan.name}}</title>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.14/angular.min.js"></script>
  <script src="//maps.googleapis.com/maps/api/js?sensor=false"></script>
  <script src="/static/js/script.js"></script>
  <link type="text/css" rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <div id="entity-container">
    <h2 class="trip-title">{{plan.title}}</h2>
    {% for entity_type in plan.TYPES_IN_ORDER %}
      {% if plan.entities_for_type(entity_type) %}
        <div ng-init='entityType = "{{entity_type}}"; entities = {{plan.entities_json_str_for_type(entity_type)}}'>
          <div class="one-entity-type" ng-controller="EntityTypeCtrl">
            <h3 ng-click="toggleSection()" class="entity-type-header">
              {{entity_type}}
            </h3>
            <div class="columns" ng-show="show">
              <div ng-repeat="entityModel in entityModels">
                <div class="one-entity" ng-mouseover="openInfowindow(entityModel.data['name'])" ng-controller="EntityCtrl">
                  <div class="one-entity-title">[[entityModel.data['name'] ]]</div>
                  <div class="one-entity-content">
                    <img class="entity-main-img" ng-src="[[entityModel.data['primary_photo_url'] ]]"/>
                  </div>
                  <div>
                    Rating: [[entityModel.data['rating'] ]]
                  </div>
                  <div class="entity-description"
                    ng-show="entityModel.hasDescription() && !editing">
                    <div style="white-space:pre">[[entityModel.data['description'] ]]</div>
                  </div>
                  <div ng-show="editing">
                    <textarea ng-model="entityModel.data['description']" class="entity-description-input"></textarea>
                    <button ng-click="saveEntityEdit()">Save</button>
                  </div>
                  <div>
                    Clipped from <a ng-href="[[entityModel.data['source_url'] ]]" target="_blank">[[entityModel.data['source_url'] | hostname ]]</a>
                  </div>
                  <div class="entity-edit-link" ng-show="!editing">
                    <a href="javascript:void(0)" ng-click="openEditEntity(entityModel.data['name'])">Edit</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      {% endif %}
    {% endfor %}

  <div id="map-container">
    <div id="map">
    </div>
  </div>

  <script>
    initApp();
  </script>
</body>
</html>
