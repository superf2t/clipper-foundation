<!doctype html>
<html>
<head>
  <title>Travel Clipper</title>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="//maps.googleapis.com/maps/api/js?libraries=places&sensor=false"></script>
  <script src="//cdn.jsdelivr.net/underscorejs/1.6.0/underscore-min.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.2.14/angular.min.js"></script>
  <script src="/static/js/ui-bootstrap-tpls-0.11.0.min.js"></script>
  <script src="/static/js/services.js"></script>
  <script src="/static/js/script.js"></script>
  <script src="/static/js/internal_clipper.js"></script>
  <link type="text/css" rel="stylesheet" href="//fonts.googleapis.com/css?family=Raleway:300|Nunito:300,400">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  <link rel="stylesheet" href="/static/css/style.css">
  <link rel="stylesheet" href="/static/css/internal_clipper.css">
  <link rel="shortcut icon" href="/static/img/globe.png">
  {% include 'analytics.html' %}
</head>
<body ng-controller="InternalClipperRootCtrl" class="clipper-body">

  <div ng-show="s.state == ClipperState.SUMMARY">
    <div class="trip-plan-panel" ng-controller="TripPlanPanelCtrl">
      <select ng-model="s.tripPlan" ng-options="t['name'] for t in allTripPlans"
        class="form-control">
      </select>
      <div class="control-links">
        <a href="javascript:void(0)" class="color-link">
          <span class="glyphicon glyphicon-pencil"></span> Edit          
        </a>
        <a ng-href="/admin/editor/[[s.tripPlan['trip_plan_id'] ]]" target="_blank" class="color-link">
          <span class="glyphicon glyphicon-wrench"></span> Admin editor
        </a>
        <a ng-href="/trip_plan/[[s.tripPlan['trip_plan_id'] ]]" target="_blank" class="color-link">
          <span class="glyphicon glyphicon-new-window"></span> View trip
        </a>
      </div>
      <div class="location-section">
        Location:
        <span class="location-name" ng-show="s.tripPlanModel.hasLocation()">
          [[s.tripPlan['location_name'] ]]
        </span>
        <span class="text-danger" ng-show="!s.tripPlanModel.hasLocation()">
          missing
        </span>
      </div>
      <div class="description">[[s.tripPlan['description'] ]]</div>
    </div>

    <div class="entity-panel">
      <div class="num-entities">[[s.entities.length]] Entities</div>
      <tc-entity-listing ng-repeat="entity in s.entities" entity="entity">
      </tc-entity-listing>
    </div>
  </div>

  <div ng-show="stateModel.state == ClipperState.EDIT_TRIP_PLAN"
    ng-controller="EditTripPlanCtrl">
  </div>

  <div ng-show="stateModel.state == ClipperState.EDIT_ENTITY"
    ng-controller="EditEntityCtrl">
  </div>

  <script type="text/ng-template" id="one-entity-listing-template">
    <div class="one-entity-listing">
      <span class="entity-circle-img">
        <img ng-src="[[im.getBackgroundImageUrl()]]" draggable="false"/>
      </span>
      <span class="entity-info">
        <div class="name">
          [[ed['name'] ]]
        </div>
        <div class="details">
          <span ng-show="im.hasCategory()"
            ng-class="'text-' + ed['category']['name']">
            [[ed['category']['display_name'] ]]
          </span>
          <span ng-show="im.hasSubCategory()"
            ng-class="'text-' + ed['category']['name']">
            > [[ed['sub_category']['display_name'] ]]
          </div>
          <span ng-show="im.day()" ng-class="day">
            Day [[im.day()]]
          </span>
          <span class="glyphicon glyphicon-star favorite-star" ng-show="ed['starred']">
          </span>
          {# TODO: Add warnings for missing fields. #}
        </div>
      </span>
    </div>
  </script>

  <script>
    initClipper(
      {{all_trip_plans_json|safe}},
      {{all_datatype_values.to_json_str()|safe}});
  </script>
</body>
</html>
