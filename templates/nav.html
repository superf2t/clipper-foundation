<link rel="stylesheet" href="/static/css/nav.css"/>
<script src="/static/js/nav.js"></script>

<script type="text/ng-template" id="nav-template">
  <nav class="navbar navbar-defaulst navbar-fixed-top main-nav" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand main-logo" href="/">TravelClipper</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right right-controls">
          <li>
            <ul class="nav nav-pills">
              <li ng-if="shoppingCartMode && activeTripPlan" class="trip-plan-name">
                <a ng-href="/trip_plan/[[activeTripPlan['trip_plan_id'] ]]" target="_blank">
                  [[activeTripPlan['name'] ]]
                </a>
              </li>
              <li ng-if="shoppingCartMode && activeTripPlan" class="place-count">
                <a href="javascript:void(0)">
                  [[numEntities()]]
                </a>
              </li>
              <li ng-if="shoppingCartMode && activeTripPlan" class="new-trip-item dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle">
                  <span tc-icon="trip-plan" class="trip-menu-icon"></span>
                </a>
                <tc-nav-trip-plan-dropdown></tc-nav-trip-plan-dropdown>
              </li>
              <li ng-if="!activeTripPlan" class="new-trip-item">
                <a href="javascript:void(0)">
                  <span tc-icon="trip-plan" class="trip-menu-icon"></span>
                  <span class="new-trip-text">New Trip</span>
                </a>
              </li>
              <li ng-if="!shoppingCartMode && activeTripPlan" class="dropdown">
                <a href="javascript:void(0)" class="dropdown-toggle">
                  My Trips
                  <span class="caret"></span>
                </a>
                <tc-nav-trip-plan-dropdown></tc-nav-trip-plan-dropdown>
              </li>
              {% if session_info.logged_in() %}
              <li class="dropdown">
                <a class="dropdown-toggle" href="javascript:void(0)">
                  [[accountInfo['user']['display_name'] ]]
                  <span class="caret"></span>
                </a>
                <tc-account-dropdown></tc-account-dropdown>
              </li>
              {% else %}
              <li>
                <a ng-click="openLoginModal('{{register_iframe_url}}', 'login-modal-window')"
                  href="javascript:void(0)">
                  Join
                </a>
              </li>
              <li class="nav-pill-separator">|</li>
              <li>
                <a ng-click="openLoginModal('{{login_iframe_url}}', 'login-modal-window')"
                  href="javascript:void(0)">
                  Log in
                </a>
              </li>
              {% endif %}
            <ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>
</script>

<script type="text/ng-template" id="flashed-messages-template">
  <div ng-controller="FlashedMessagesCtrl" class="ng-cloak">
    <div class="flashed-msgs" ng-if="hasMessages()">
      <div ng-repeat="msg in messages"
        ng-init="textClass = msg['category'] == 'error' ? 'text-danger' : 'text-' + msg['category']">
        <div class="flash-msg" ng-class="textClass">
          <div class="dismiss-link">
            <a ng-click="dismiss($index)" href="javascript:void(0)">
              <span class="glyphicon glyphicon-remove"></span>
            </a>
          </div>
          [[ msg['message'] ]]
        </div>
      </div>
    </div>
  </div>
</script>

<script type="text/ng-template" id="login-modal-template">
  <div class="login-modal">
    <iframe class="login-iframe" ng-src="[[iframeUrl]]">
    </iframe>
  </div>
</script>

<script type="text/ng-template" id="account-dropdown-template">
  <ul class="account-dropdown dropdown-menu">
    <li>
      <a href="javascript:void(0)">
        Profile
      </a>
    </li>
    <li>
      <a href="javascript:void(0)">
        Settings
      </a>
    </li>
    <li>
      <a href="javascript:void(0)">
        Give feedback
      </a>
    </li>
    <li class="logout-item">
      <a href="{{logout_url}}">
        Log out
      </a>
    </li>
  </ul>
</script>

<script type="text/ng-template" id="nav-trip-plan-dropdown-template">
  <ul class="nav-trip-plan-dropdown dropdown-menu">
    <span ng-show="allTripPlans && allTripPlans.length">
      <li class="select-trip-prompt">
        Select trip to add places
      </li>
      <li ng-repeat="tripPlan in allTripPlans">
        <a href="javascript:void(0)">
          [[tripPlan['name'] ]]
        </a>
      </li>
      <li class="or-text">
        Or
      </li>
    </span>
    <li class="create-new-trip-link">
      <a href="javascript:void(0)">
        Create New Trip
      </a>
    </li>
  </ul>
</script>
