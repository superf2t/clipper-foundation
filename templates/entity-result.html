<script type="text/ng-template" id="one-entity-result-template">
  <div ng-controller="EntityResultCtrl" class="one-entity-result-row">
    <div ng-if="showCheckboxes" class="checkbox-container">
      <div ng-click="ed.selected = !ed.selected" class="entity-checkbox">
        <span class="glyphicon glyphicon-check" ng-show="ed.selected"></span>
        <span class="glyphicon glyphicon-unchecked" ng-show="!ed.selected"></span>
      </div>
    </div>
    <div ng-class="{'row-with-checkbox': showCheckboxes}">
      <div class="container-fluid one-entity-result"
        ng-class="{'selected': clickToSelect && ed.selected, 'selectable': clickToSelect}"
        ng-click="clickToSelect && (ed.selected = !ed.selected)">
        <div class="row main-row">
          <div class="col-xs-4 img-container"
            ng-style="{'background-image': 'url(&quot;' + im.getBackgroundImageUrl(activeTripPlan['location_latlng']) +'&quot;)'}">
          </div>
          <div class="col-xs-8 details-container">
            <div class="main-details">
              <div class="title">
                [[ed['name'] ]]
              </div>
              <div class="note-control" ng-show="!editing()" ng-if="editable">
                <a ng-click="openEditNote()" href="javascript:void(0)">
                  <span class="glyphicon glyphicon-pencil"></span> Add note
                </a>
              </div>
              <div class="edit-close-control" ng-show="editing()">
                <a ng-click="closeEditor()" href="javascript:void(0)">
                  <span class="glyphicon glyphicon-chevron-up"></span>
                </a>
              </div>
              <div class="main-controls" ng-if="editable">
                <a ng-if="!em.hasLocation()" ng-click="openEditLocation()">
                  <span class="glyphicon glyphicon-exclamation-sign"
                    tooltip="No location found for this place.  Click to add one."
                    tooltip-placement="left" tooltip-append-to-body="true">
                  </span>
                </a>
                <a href="javascript:void(0)" class="dropdown-toggle">
                  <span class="glyphicon glyphicon-cog"></span>
                </a>
                <ul class="dropdown-menu right-bottom-dropdown-menu">
                  <li>
                    <a ng-click="openEditLocation()" href="javascript:void(0)">
                      <span class="glyphicon glyphicon-edit"></span> Edit name and location
                    </a>
                  </li>
                  <li>
                    <a ng-click="openEditPhotos()" href="javascript:void(0)">
                      <span class="glyphicon glyphicon-camera"></span> Edit photos
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row expanded-row" ng-show="editing()">
          <div ng-show="state == EntityResultState.EDITING_NOTE">
            <textarea class="form-control note-input" placeholder="Add a note" ng-model="ed['description']"
              tc-focus-on="state">
            </textarea>
          </div>
          <div ng-show="state == EntityResultState.EDITING_LOCATION" class="location-editor">
            <input class="form-control" ng-model="ed['name']" placeholder="Name of place"
              tc-focus-on="state"/>
            <input class="form-control" ng-model="ed['address']" placeholder="Address"
              tc-google-place-autocomplete search-bounds-json="activeTripPlan['location_bounds']"
              location-types="geocode" on-place-change="addressSelected($newPlace)"/>
            <div class="map-container">
              <div class="map" tc-google-map map="map" map-options="mapOptions" after-creation="setupMap($map)"
                resize-when="state == EntityResultState.EDITING_LOCATION">
              </div>
            </div>
          </div>
          <div ng-show="state == EntityResultState.EDITING_PHOTOS" class="photo-editor"
            ng-controller="EntityResultPhotoCtrl">
            <div ng-if="hasImgs()" class="photo-carousel">
              <a ng-click="prevImg()" ng-show="hasPrevImg()" class="img-carousel-control left" href="javascript:void(0)">
                <span class="glyphicon glyphicon-chevron-left"></span>
              </a>
              <span class="carousel-img-container">
                <div class="img-overlay-control top">
                  <a ng-click="setAsPrimary()" href="javascript:void(0)">
                    <span class="glyphicon glyphicon-picture"></span> Set as primary
                  </a>
                </div>
                <img ng-src="[[selectedImg()]]" ng-click="nextImg()"/>
                <div class="img-overlay-control bottom">
                  <a ng-click="deletePhoto()" href="javascript:void(0)">
                    <span class="glyphicon glyphicon-trash"></span> Delete photo
                  </a>
                </div>
              </span>
              <a ng-click="nextImg()" ng-show="hasNextImg()" class="img-carousel-control right" href="javascript:void(0)">
                <span class="glyphicon glyphicon-chevron-right"></span>
              </a>
            </div>
            <div class="imgs-prompt">
              <textarea class="form-control" disabled="1">Drag and drop images anywhere in the clipper to add them</textarea>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</script>
